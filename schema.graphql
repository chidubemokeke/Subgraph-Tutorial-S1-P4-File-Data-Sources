# Enum for Transaction Types
enum TransactionType {
  SALE
  MINT
}

type Account @entity {
  id: ID!
  buyCount: BigInt
  saleCount: BigInt
  mintCount: BigInt
  totalBalance: BigInt
  blockNumber: BigInt!
  blockTimestamp: BigInt!
  nfts: [NFT!]! @derivedFrom(field: "currentOwner") # All NFTs owned by Account
  transactions: [Transaction!]! @derivedFrom(field: "account")
}

type Transaction @entity {
  id: ID!
  account: Account! # Updated field name for clarity
  from: Bytes! # Address of sender if mint
  to: Bytes! # Address of receiver
  tokenId: BigInt! # uint256
  buyer: Bytes
  seller: Bytes
  type: TransactionType! # Enum for transaction type (SALE or MINT)
  nft: NFT! # Reference to the NFT involved in the transaction
  amountSold: BigInt
  totalAmountSold: BigInt
  totalAmountBought: BigInt
  blockNumber: BigInt!
  blockTimestamp: BigInt!
}

type NFT @entity {
  id: ID!
  currentOwner: Account!
  tokenID: BigInt!
  tokenURI: String!
  ipfsURI: NFTMetadata
  firstOwner: Bytes!
  saleCount: BigInt! # Total count of sales
  buyCount: BigInt! # Total count of buys
  mintCount: BigInt! # Total count of mints
  transfers: [Transaction!]! @derivedFrom(field: "nft") # All transactions involving this NFT
  blockTimestamp: BigInt!
  blockNumber: BigInt!
}

type NFTMetadata @entity {
  id: ID!
  description: String!
  externalURL: String
  image: String!
  name: String!
  type: String!
  sun: String!
  moon: String!
  rising: String!
}
